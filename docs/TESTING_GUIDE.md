# üß™ AI Assistant - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã](#–æ–±—â–∏–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ç–µ—Å—Ç–æ–≤)
3. [–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤](#—Ç–∏–ø—ã-—Ç–µ—Å—Ç–æ–≤)
4. [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤)
5. [–ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤](#–Ω–∞–ø–∏—Å–∞–Ω–∏–µ-—Ç–µ—Å—Ç–æ–≤)
6. [–û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤](#–æ—Ç–ª–∞–¥–∫–∞-—Ç–µ—Å—Ç–æ–≤)
7. [CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#cicd-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

## üéØ –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
     üî∫ E2E Tests (5-10%)
    üî∫üî∫ Integration Tests (20-30%)
   üî∫üî∫üî∫ Unit Tests (60-70%)
```

### –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
1. **Fast** - –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ
2. **Independent** - –¢–µ—Å—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
3. **Repeatable** - –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º
4. **Self-Validating** - –¢–µ—Å—Ç –¥–æ–ª–∂–µ–Ω —á–µ—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á—É
5. **Timely** - –¢–µ—Å—Ç—ã –ø–∏—à—É—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∫–æ–¥–æ–º

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ conftest.py                 # –û–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ unit/                       # –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã (60-70%)
‚îÇ   ‚îú‚îÄ‚îÄ test_api_users.py      # –¢–µ—Å—Ç—ã API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ test_search_service.py # –¢–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py           # –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_models.py         # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ integration/                # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (20-30%)
‚îÇ   ‚îú‚îÄ‚îÄ test_api_v1.py         # –¢–µ—Å—Ç—ã API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_database.py       # –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ test_external_apis.py  # –¢–µ—Å—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö API
‚îú‚îÄ‚îÄ e2e/                        # End-to-end —Ç–µ—Å—Ç—ã (5-10%)
‚îÇ   ‚îú‚îÄ‚îÄ test_user_journey.py   # –ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_workflows.py      # –ë–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã
‚îú‚îÄ‚îÄ performance/                # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_load.py           # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_stress.py         # –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ fixtures/                   # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ sample_documents.json
    ‚îî‚îÄ‚îÄ mock_responses.json
```

## üî¨ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Å–µ—Ä–≤–∏—Å–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

**–ü—Ä–∏–º–µ—Ä:**
```python
# tests/unit/test_search_service.py
import pytest
from unittest.mock import Mock, AsyncMock

from app.services.search_service import SearchService

class TestSearchService:
    @pytest.fixture
    def search_service(self):
        return SearchService()
    
    @pytest.fixture
    def mock_vector_db(self):
        mock = Mock()
        mock.search = AsyncMock(return_value=[
            {"id": "doc1", "score": 0.95, "content": "test content"}
        ])
        return mock
    
    async def test_semantic_search_success(self, search_service, mock_vector_db):
        # Arrange
        search_service.vector_db = mock_vector_db
        query = "test query"
        
        # Act
        results = await search_service.semantic_search(query)
        
        # Assert
        assert len(results) == 1
        assert results[0]["score"] > 0.9
        mock_vector_db.search.assert_called_once_with(query)
    
    async def test_search_with_invalid_query(self, search_service):
        # Arrange
        empty_query = ""
        
        # Act & Assert
        with pytest.raises(ValueError, match="Query cannot be empty"):
            await search_service.semantic_search(empty_query)
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –†–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- API endpoints —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```python
# tests/integration/test_api_v1.py
import pytest
from fastapi.testclient import TestClient

from tests.conftest import create_test_app

@pytest.mark.integration
class TestSearchAPI:
    @pytest.fixture
    def client(self):
        app = create_test_app()
        return TestClient(app)
    
    @pytest.fixture
    def auth_headers(self):
        return {"Authorization": "Bearer test-token"}
    
    def test_search_endpoint_integration(self, client, auth_headers):
        # Arrange
        search_request = {
            "query": "authentication best practices",
            "sources": ["confluence_main"],
            "limit": 5
        }
        
        # Act
        response = client.post(
            "/api/v1/search/", 
            json=search_request,
            headers=auth_headers
        )
        
        # Assert
        assert response.status_code == 200
        data = response.json()
        assert "results" in data
        assert "total_results" in data
        assert isinstance(data["results"], list)
    
    def test_search_with_database(self, client, auth_headers, test_db):
        # –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
        # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        pass
```

### 3. End-to-End —Ç–µ—Å—Ç—ã

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- –ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã

**–ü—Ä–∏–º–µ—Ä:**
```python
# tests/e2e/test_user_journey.py
import pytest
from selenium import webdriver
from selenium.webdriver.common.by import By

@pytest.mark.e2e
class TestUserJourney:
    @pytest.fixture
    def driver(self):
        driver = webdriver.Chrome()
        yield driver
        driver.quit()
    
    def test_complete_search_workflow(self, driver):
        # 1. –û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        driver.get("http://localhost:3000")
        
        # 2. –õ–æ–≥–∏–Ω
        login_button = driver.find_element(By.ID, "login-button")
        login_button.click()
        
        # 3. –ü–æ–∏—Å–∫
        search_input = driver.find_element(By.ID, "search-input")
        search_input.send_keys("API documentation")
        
        search_button = driver.find_element(By.ID, "search-button")
        search_button.click()
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        results = driver.find_elements(By.CLASS_NAME, "search-result")
        assert len(results) > 0
        
        # 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        results[0].click()
        
        detail_content = driver.find_element(By.ID, "result-detail")
        assert detail_content.is_displayed()
```

### 4. –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API
- –ü—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä:**
```python
# tests/performance/test_load.py
import pytest
import asyncio
import time
from concurrent.futures import ThreadPoolExecutor

from fastapi.testclient import TestClient
from tests.conftest import create_test_app

@pytest.mark.performance
class TestAPIPerformance:
    @pytest.fixture
    def client(self):
        app = create_test_app()
        return TestClient(app)
    
    def test_search_response_time(self, client):
        # Arrange
        search_request = {"query": "test", "limit": 10}
        
        # Act
        start_time = time.time()
        response = client.post("/api/v1/search/", json=search_request)
        end_time = time.time()
        
        # Assert
        assert response.status_code == 200
        response_time = end_time - start_time
        assert response_time < 2.0  # –ú–∞–∫—Å–∏–º—É–º 2 —Å–µ–∫—É–Ω–¥—ã
    
    def test_concurrent_requests(self, client):
        # –¢–µ—Å—Ç –Ω–∞ 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        def make_request():
            return client.post("/api/v1/search/", json={"query": "test"})
        
        with ThreadPoolExecutor(max_workers=10) as executor:
            futures = [executor.submit(make_request) for _ in range(100)]
            responses = [f.result() for f in futures]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —É—Å–ø–µ—à–Ω—ã
        success_count = sum(1 for r in responses if r.status_code == 200)
        assert success_count >= 95  # 95% —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
python -m pytest tests/

# –¢–æ–ª—å–∫–æ —é–Ω–∏—Ç —Ç–µ—Å—Ç—ã
python -m pytest tests/unit/ -v

# –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
python -m pytest tests/integration/ -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
python -m pytest tests/unit/test_api_users.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
python -m pytest tests/unit/test_api_users.py::TestUsersAPI::test_create_user -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
python -m pytest tests/ --cov=app --cov-report=html

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
python -m pytest tests/ -n auto

# –° –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
python -m pytest tests/unit/test_api_users.py -v -s --tb=long
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

```bash
# –ü–æ –º–∞—Ä–∫–µ—Ä–∞–º
python -m pytest -m "unit"
python -m pytest -m "integration"
python -m pytest -m "e2e"
python -m pytest -m "not slow"

# –ü–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
python -m pytest -k "search"
python -m pytest -k "api and user"
python -m pytest -k "not database"

# –¢–æ–ª—å–∫–æ —É–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã
python -m pytest --lf

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
python -m pytest -x

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
python -m pytest --durations=10
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest

```ini
# pytest.ini
[tool:pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = 
    -v
    --strict-markers
    --disable-warnings
    --tb=short
markers =
    unit: Unit tests
    integration: Integration tests
    e2e: End-to-end tests
    slow: Slow running tests
    performance: Performance tests
    api: API tests
    database: Database tests
```

## ‚úçÔ∏è –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞ (AAA Pattern)

```python
def test_example():
    # Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–∫–æ–≤
    user_data = {"name": "Test User", "email": "test@example.com"}
    mock_service = Mock()
    mock_service.create_user.return_value = {"id": 1, **user_data}
    
    # Act - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
    result = user_service.create_user(user_data)
    
    # Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    assert result["id"] == 1
    assert result["name"] == "Test User"
    mock_service.create_user.assert_called_once_with(user_data)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä

```python
# conftest.py - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
@pytest.fixture
def test_db():
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    # Setup
    engine = create_test_engine()
    TestingSessionLocal = sessionmaker(bind=engine)
    Base.metadata.create_all(bind=engine)
    
    db = TestingSessionLocal()
    yield db
    
    # Teardown
    db.close()
    Base.metadata.drop_all(bind=engine)

@pytest.fixture
def sample_user():
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    return {
        "user_id": "test-user-123",
        "email": "test@example.com",
        "name": "Test User",
        "is_active": True
    }

# test_*.py - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä
def test_user_creation(test_db, sample_user):
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å—Ç—É—Ä—ã –≤ —Ç–µ—Å—Ç–µ
    user = User(**sample_user)
    test_db.add(user)
    test_db.commit()
    
    assert user.id is not None
```

### –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```python
from unittest.mock import Mock, AsyncMock, patch

class TestLLMService:
    @pytest.fixture
    def mock_openai_client(self):
        mock = Mock()
        mock.chat.completions.create = AsyncMock(
            return_value=Mock(
                choices=[Mock(message=Mock(content="Test response"))]
            )
        )
        return mock
    
    @patch('app.services.llm_service.OpenAI')
    async def test_generate_response(self, mock_openai_class, mock_openai_client):
        # Arrange
        mock_openai_class.return_value = mock_openai_client
        service = LLMService()
        
        # Act
        response = await service.generate_response("Test prompt")
        
        # Assert
        assert response == "Test response"
        mock_openai_client.chat.completions.create.assert_called_once()
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```python
def test_invalid_user_data():
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    with pytest.raises(ValueError, match="Email is required"):
        create_user({"name": "Test"})  # –ë–µ–∑ email
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    with pytest.raises(ValidationError):
        validate_user_data({})

def test_http_exceptions():
    with pytest.raises(HTTPException) as exc_info:
        raise HTTPException(status_code=404, detail="User not found")
    
    assert exc_info.value.status_code == 404
    assert "not found" in exc_info.value.detail.lower()
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

```python
@pytest.mark.parametrize("email,expected", [
    ("test@example.com", True),
    ("invalid-email", False),
    ("", False),
    ("test@", False),
    ("@example.com", False),
])
def test_email_validation(email, expected):
    result = validate_email(email)
    assert result == expected

@pytest.mark.parametrize("user_data,error_message", [
    ({"name": ""}, "Name cannot be empty"),
    ({"email": "invalid"}, "Invalid email format"),
    ({"age": -1}, "Age must be positive"),
])
def test_user_validation_errors(user_data, error_message):
    with pytest.raises(ValidationError, match=error_message):
        validate_user(user_data)
```

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

```python
# 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ print statements
def test_debug_example():
    result = some_function()
    print(f"Result: {result}")  # –ó–∞–ø—É—Å–∫ —Å -s —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å print
    assert result == expected

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pdb
def test_with_debugger():
    import pdb; pdb.set_trace()  # –¢–æ—á–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∞
    result = some_function()
    assert result == expected

# 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö
import logging
logging.basicConfig(level=logging.DEBUG)

def test_with_logging():
    logger = logging.getLogger(__name__)
    logger.debug("Starting test")
    result = some_function()
    logger.debug(f"Got result: {result}")
    assert result == expected
```

### –ó–∞–ø—É—Å–∫ —Å –æ—Ç–ª–∞–¥–∫–æ–π

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å print statements
python -m pytest tests/unit/test_api.py -s

# –ü–æ–¥—Ä–æ–±–Ω—ã–π traceback
python -m pytest tests/unit/test_api.py --tb=long

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
python -m pytest tests/unit/test_api.py -x

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —É–ø–∞–≤—à–∏—Ö —Ç–µ—Å—Ç–æ–≤
python -m pytest --lf

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
python -m pytest tests/unit/test_api.py --pdb
```

### –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
python -m pytest tests/ --cov=app --cov-report=html

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è
python -m pytest tests/ --cov=app --cov-report=term-missing

# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è
python -m pytest tests/ --cov=app --cov-fail-under=80
```

## üîÑ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

```yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: password
          POSTGRES_DB: test_db
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        pip install -r requirements.txt
        pip install pytest-cov
    
    - name: Run unit tests
      run: |
        python -m pytest tests/unit/ -v --cov=app
    
    - name: Run integration tests
      run: |
        python -m pytest tests/integration/ -v
      env:
        DATABASE_URL: postgresql://postgres:password@localhost:5432/test_db
        REDIS_URL: redis://localhost:6379
    
    - name: Upload coverage
      uses: codecov/codecov-action@v3
      with:
        file: ./coverage.xml
```

### Makefile –¥–ª—è —Ç–µ—Å—Ç–æ–≤

```makefile
# Makefile
.PHONY: test test-unit test-integration test-e2e test-coverage

test: test-unit test-integration

test-unit:
	python -m pytest tests/unit/ -v

test-integration:
	python -m pytest tests/integration/ -v

test-e2e:
	python -m pytest tests/e2e/ -v

test-coverage:
	python -m pytest tests/ --cov=app --cov-report=html --cov-report=term

test-performance:
	python -m pytest tests/performance/ -v

test-docker:
	docker-compose -f docker-compose.test.yml up --abort-on-container-exit

clean-test:
	rm -rf .pytest_cache/
	rm -rf htmlcov/
	rm -f .coverage
```

### Pre-commit hooks

```yaml
# .pre-commit-config.yaml
repos:
  - repo: local
    hooks:
      - id: tests
        name: Run tests
        entry: python -m pytest tests/unit/ -q
        language: system
        pass_filenames: false
        always_run: true
      
      - id: coverage
        name: Check coverage
        entry: python -m pytest tests/unit/ --cov=app --cov-fail-under=80
        language: system
        pass_filenames: false
        always_run: true
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: > 80%
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —é–Ω–∏—Ç —Ç–µ—Å—Ç–æ–≤**: < 30 —Å–µ–∫—É–Ω–¥
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤**: < 5 –º–∏–Ω—É—Ç
- **–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤**: > 95%

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
flake8 app/ tests/
black --check app/ tests/
mypy app/

# –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
radon cc app/ -a
radon mi app/

# –ü–æ–∏—Å–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
pylint app/ tests/
```

---

*–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å AI Assistant –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞.* 